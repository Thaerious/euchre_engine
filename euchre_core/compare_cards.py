"""
compare_cards.py

Provides logic for comparing Euchre cards based on trump and lead suit.
A central `lookup_table` is used to assign a rank to each card depending
on the context (trump suit and lead suit). Includes helper functions:

- `compare_cards`: Returns a numerical comparison of two cards.
- `best_card`: Returns the stronger of two cards.
- `worst_card`: Returns the weaker of two cards.

Useful for determining trick winners and AI decisions.
"""

from typing import Optional

lookup_table = {
    "♠": {"♠": {}, "♥": {}, "♣": {}, "♦": {}, None: {}},
    "♥": {"♠": {}, "♥": {}, "♣": {}, "♦": {}, None: {}},
    "♣": {"♠": {}, "♥": {}, "♣": {}, "♦": {}, None: {}},
    "♦": {"♠": {}, "♥": {}, "♣": {}, "♦": {}, None: {}},
    None: {"♠": {}, "♥": {}, "♣": {}, "♦": {}, None: {}},
}

# [trump][lead][card] = rank
lookup_table["♠"]["♠"] = {
    "J♠": 24,
    "J♣": 23,
    "A♠": 22,
    "K♠": 21,
    "Q♠": 20,
    "10♠": 19,
    "9♠": 18,
    "A♥": 17,
    "A♣": 17,
    "A♦": 17,
    "K♥": 16,
    "K♣": 16,
    "K♦": 16,
    "Q♥": 15,
    "Q♣": 15,
    "Q♦": 15,
    "J♥": 14,
    "J♦": 14,
    "10♥": 13,
    "10♣": 13,
    "10♦": 13,
    "9♥": 12,
    "9♣": 12,
    "9♦": 12,
}
lookup_table["♠"]["♥"] = {
    "J♠": 24,
    "J♣": 23,
    "A♠": 22,
    "K♠": 21,
    "Q♠": 20,
    "10♠": 19,
    "9♠": 18,
    "A♥": 17,
    "K♥": 16,
    "Q♥": 15,
    "J♥": 14,
    "10♥": 13,
    "9♥": 12,
    "A♣": 11,
    "A♦": 11,
    "K♣": 10,
    "K♦": 10,
    "Q♣": 9,
    "Q♦": 9,
    "J♦": 8,
    "10♣": 7,
    "10♦": 7,
    "9♣": 6,
    "9♦": 6,
}
lookup_table["♠"]["♣"] = {
    "J♠": 24,
    "J♣": 23,
    "A♠": 22,
    "K♠": 21,
    "Q♠": 20,
    "10♠": 19,
    "9♠": 18,
    "A♣": 17,
    "K♣": 16,
    "Q♣": 15,
    "10♣": 14,
    "9♣": 13,
    "A♥": 12,
    "A♦": 12,
    "K♥": 11,
    "K♦": 11,
    "Q♥": 10,
    "Q♦": 10,
    "J♥": 9,
    "J♦": 9,
    "10♥": 8,
    "10♦": 8,
    "9♥": 7,
    "9♦": 7,
}
lookup_table["♠"]["♦"] = {
    "J♠": 24,
    "J♣": 23,
    "A♠": 22,
    "K♠": 21,
    "Q♠": 20,
    "10♠": 19,
    "9♠": 18,
    "A♦": 17,
    "K♦": 16,
    "Q♦": 15,
    "J♦": 14,
    "10♦": 13,
    "9♦": 12,
    "A♥": 11,
    "A♣": 11,
    "K♥": 10,
    "K♣": 10,
    "Q♥": 9,
    "Q♣": 9,
    "J♥": 8,
    "10♥": 7,
    "10♣": 7,
    "9♥": 6,
    "9♣": 6,
}
lookup_table["♠"][None] = {
    "J♠": 24,
    "J♣": 23,
    "A♠": 22,
    "K♠": 21,
    "Q♠": 20,
    "10♠": 19,
    "9♠": 18,
    "A♥": 17,
    "A♣": 17,
    "A♦": 17,
    "K♥": 16,
    "K♣": 16,
    "K♦": 16,
    "Q♥": 15,
    "Q♣": 15,
    "Q♦": 15,
    "J♥": 14,
    "J♦": 14,
    "10♥": 13,
    "10♣": 13,
    "10♦": 13,
    "9♥": 12,
    "9♣": 12,
    "9♦": 12,
}
lookup_table["♥"]["♠"] = {
    "J♥": 24,
    "J♦": 23,
    "A♥": 22,
    "K♥": 21,
    "Q♥": 20,
    "10♥": 19,
    "9♥": 18,
    "A♠": 17,
    "K♠": 16,
    "Q♠": 15,
    "J♠": 14,
    "10♠": 13,
    "9♠": 12,
    "A♣": 11,
    "A♦": 11,
    "K♣": 10,
    "K♦": 10,
    "Q♣": 9,
    "Q♦": 9,
    "J♣": 8,
    "10♣": 7,
    "10♦": 7,
    "9♣": 6,
    "9♦": 6,
}
lookup_table["♥"]["♥"] = {
    "J♥": 24,
    "J♦": 23,
    "A♥": 22,
    "K♥": 21,
    "Q♥": 20,
    "10♥": 19,
    "9♥": 18,
    "A♠": 17,
    "A♣": 17,
    "A♦": 17,
    "K♠": 16,
    "K♣": 16,
    "K♦": 16,
    "Q♠": 15,
    "Q♣": 15,
    "Q♦": 15,
    "J♠": 14,
    "J♣": 14,
    "10♠": 13,
    "10♣": 13,
    "10♦": 13,
    "9♠": 12,
    "9♣": 12,
    "9♦": 12,
}
lookup_table["♥"]["♣"] = {
    "J♥": 24,
    "J♦": 23,
    "A♥": 22,
    "K♥": 21,
    "Q♥": 20,
    "10♥": 19,
    "9♥": 18,
    "A♣": 17,
    "K♣": 16,
    "Q♣": 15,
    "J♣": 14,
    "10♣": 13,
    "9♣": 12,
    "A♠": 11,
    "A♦": 11,
    "K♠": 10,
    "K♦": 10,
    "Q♠": 9,
    "Q♦": 9,
    "J♠": 8,
    "10♠": 7,
    "10♦": 7,
    "9♠": 6,
    "9♦": 6,
}
lookup_table["♥"]["♦"] = {
    "J♥": 24,
    "J♦": 23,
    "A♥": 22,
    "K♥": 21,
    "Q♥": 20,
    "10♥": 19,
    "9♥": 18,
    "A♦": 17,
    "K♦": 16,
    "Q♦": 15,
    "10♦": 14,
    "9♦": 13,
    "A♠": 12,
    "A♣": 12,
    "K♠": 11,
    "K♣": 11,
    "Q♠": 10,
    "Q♣": 10,
    "J♠": 9,
    "J♣": 9,
    "10♠": 8,
    "10♣": 8,
    "9♠": 7,
    "9♣": 7,
}
lookup_table["♥"][None] = {
    "J♥": 24,
    "J♦": 23,
    "A♥": 22,
    "K♥": 21,
    "Q♥": 20,
    "10♥": 19,
    "9♥": 18,
    "A♠": 17,
    "A♣": 17,
    "A♦": 17,
    "K♠": 16,
    "K♣": 16,
    "K♦": 16,
    "Q♠": 15,
    "Q♣": 15,
    "Q♦": 15,
    "J♠": 14,
    "J♣": 14,
    "10♠": 13,
    "10♣": 13,
    "10♦": 13,
    "9♠": 12,
    "9♣": 12,
    "9♦": 12,
}
lookup_table["♣"]["♠"] = {
    "J♣": 24,
    "J♠": 23,
    "A♣": 22,
    "K♣": 21,
    "Q♣": 20,
    "10♣": 19,
    "9♣": 18,
    "A♠": 17,
    "K♠": 16,
    "Q♠": 15,
    "10♠": 14,
    "9♠": 13,
    "A♥": 12,
    "A♦": 12,
    "K♥": 11,
    "K♦": 11,
    "Q♥": 10,
    "Q♦": 10,
    "J♥": 9,
    "J♦": 9,
    "10♥": 8,
    "10♦": 8,
    "9♥": 7,
    "9♦": 7,
}
lookup_table["♣"]["♥"] = {
    "J♣": 24,
    "J♠": 23,
    "A♣": 22,
    "K♣": 21,
    "Q♣": 20,
    "10♣": 19,
    "9♣": 18,
    "A♥": 17,
    "K♥": 16,
    "Q♥": 15,
    "J♥": 14,
    "10♥": 13,
    "9♥": 12,
    "A♠": 11,
    "A♦": 11,
    "K♠": 10,
    "K♦": 10,
    "Q♠": 9,
    "Q♦": 9,
    "J♦": 8,
    "10♠": 7,
    "10♦": 7,
    "9♠": 6,
    "9♦": 6,
}
lookup_table["♣"]["♣"] = {
    "J♣": 24,
    "J♠": 23,
    "A♣": 22,
    "K♣": 21,
    "Q♣": 20,
    "10♣": 19,
    "9♣": 18,
    "A♠": 17,
    "A♥": 17,
    "A♦": 17,
    "K♠": 16,
    "K♥": 16,
    "K♦": 16,
    "Q♠": 15,
    "Q♥": 15,
    "Q♦": 15,
    "J♥": 14,
    "J♦": 14,
    "10♠": 13,
    "10♥": 13,
    "10♦": 13,
    "9♠": 12,
    "9♥": 12,
    "9♦": 12,
}
lookup_table["♣"]["♦"] = {
    "J♣": 24,
    "J♠": 23,
    "A♣": 22,
    "K♣": 21,
    "Q♣": 20,
    "10♣": 19,
    "9♣": 18,
    "A♦": 17,
    "K♦": 16,
    "Q♦": 15,
    "J♦": 14,
    "10♦": 13,
    "9♦": 12,
    "A♠": 11,
    "A♥": 11,
    "K♠": 10,
    "K♥": 10,
    "Q♠": 9,
    "Q♥": 9,
    "J♥": 8,
    "10♠": 7,
    "10♥": 7,
    "9♠": 6,
    "9♥": 6,
}
lookup_table["♣"][None] = {
    "J♣": 24,
    "J♠": 23,
    "A♣": 22,
    "K♣": 21,
    "Q♣": 20,
    "10♣": 19,
    "9♣": 18,
    "A♠": 17,
    "A♥": 17,
    "A♦": 17,
    "K♠": 16,
    "K♥": 16,
    "K♦": 16,
    "Q♠": 15,
    "Q♥": 15,
    "Q♦": 15,
    "J♥": 14,
    "J♦": 14,
    "10♠": 13,
    "10♥": 13,
    "10♦": 13,
    "9♠": 12,
    "9♥": 12,
    "9♦": 12,
}
lookup_table["♦"]["♠"] = {
    "J♦": 24,
    "J♥": 23,
    "A♦": 22,
    "K♦": 21,
    "Q♦": 20,
    "10♦": 19,
    "9♦": 18,
    "A♠": 17,
    "K♠": 16,
    "Q♠": 15,
    "J♠": 14,
    "10♠": 13,
    "9♠": 12,
    "A♥": 11,
    "A♣": 11,
    "K♥": 10,
    "K♣": 10,
    "Q♥": 9,
    "Q♣": 9,
    "J♣": 8,
    "10♥": 7,
    "10♣": 7,
    "9♥": 6,
    "9♣": 6,
}
lookup_table["♦"]["♥"] = {
    "J♦": 24,
    "J♥": 23,
    "A♦": 22,
    "K♦": 21,
    "Q♦": 20,
    "10♦": 19,
    "9♦": 18,
    "A♥": 17,
    "K♥": 16,
    "Q♥": 15,
    "10♥": 14,
    "9♥": 13,
    "A♠": 12,
    "A♣": 12,
    "K♠": 11,
    "K♣": 11,
    "Q♠": 10,
    "Q♣": 10,
    "J♠": 9,
    "J♣": 9,
    "10♠": 8,
    "10♣": 8,
    "9♠": 7,
    "9♣": 7,
}
lookup_table["♦"]["♣"] = {
    "J♦": 24,
    "J♥": 23,
    "A♦": 22,
    "K♦": 21,
    "Q♦": 20,
    "10♦": 19,
    "9♦": 18,
    "A♣": 17,
    "K♣": 16,
    "Q♣": 15,
    "J♣": 14,
    "10♣": 13,
    "9♣": 12,
    "A♠": 11,
    "A♥": 11,
    "K♠": 10,
    "K♥": 10,
    "Q♠": 9,
    "Q♥": 9,
    "J♠": 8,
    "10♠": 7,
    "10♥": 7,
    "9♠": 6,
    "9♥": 6,
}
lookup_table["♦"]["♦"] = {
    "J♦": 24,
    "J♥": 23,
    "A♦": 22,
    "K♦": 21,
    "Q♦": 20,
    "10♦": 19,
    "9♦": 18,
    "A♠": 17,
    "A♥": 17,
    "A♣": 17,
    "K♠": 16,
    "K♥": 16,
    "K♣": 16,
    "Q♠": 15,
    "Q♥": 15,
    "Q♣": 15,
    "J♠": 14,
    "J♣": 14,
    "10♠": 13,
    "10♥": 13,
    "10♣": 13,
    "9♠": 12,
    "9♥": 12,
    "9♣": 12,
}
lookup_table["♦"][None] = {
    "J♦": 24,
    "J♥": 23,
    "A♦": 22,
    "K♦": 21,
    "Q♦": 20,
    "10♦": 19,
    "9♦": 18,
    "A♠": 17,
    "A♥": 17,
    "A♣": 17,
    "K♠": 16,
    "K♥": 16,
    "K♣": 16,
    "Q♠": 15,
    "Q♥": 15,
    "Q♣": 15,
    "J♠": 14,
    "J♣": 14,
    "10♠": 13,
    "10♥": 13,
    "10♣": 13,
    "9♠": 12,
    "9♥": 12,
    "9♣": 12,
}
lookup_table[None]["♠"] = {
    "A♠": 24,
    "K♠": 23,
    "Q♠": 22,
    "J♠": 21,
    "10♠": 20,
    "9♠": 19,
    "A♥": 18,
    "A♣": 18,
    "A♦": 18,
    "K♥": 17,
    "K♣": 17,
    "K♦": 17,
    "Q♥": 16,
    "Q♣": 16,
    "Q♦": 16,
    "J♥": 15,
    "J♣": 15,
    "J♦": 15,
    "10♥": 14,
    "10♣": 14,
    "10♦": 14,
    "9♥": 13,
    "9♣": 13,
    "9♦": 13,
}
lookup_table[None]["♥"] = {
    "A♥": 24,
    "K♥": 23,
    "Q♥": 22,
    "J♥": 21,
    "10♥": 20,
    "9♥": 19,
    "A♠": 18,
    "A♣": 18,
    "A♦": 18,
    "K♠": 17,
    "K♣": 17,
    "K♦": 17,
    "Q♠": 16,
    "Q♣": 16,
    "Q♦": 16,
    "J♠": 15,
    "J♣": 15,
    "J♦": 15,
    "10♠": 14,
    "10♣": 14,
    "10♦": 14,
    "9♠": 13,
    "9♣": 13,
    "9♦": 13,
}
lookup_table[None]["♣"] = {
    "A♣": 24,
    "K♣": 23,
    "Q♣": 22,
    "J♣": 21,
    "10♣": 20,
    "9♣": 19,
    "A♠": 18,
    "A♥": 18,
    "A♦": 18,
    "K♠": 17,
    "K♥": 17,
    "K♦": 17,
    "Q♠": 16,
    "Q♥": 16,
    "Q♦": 16,
    "J♠": 15,
    "J♥": 15,
    "J♦": 15,
    "10♠": 14,
    "10♥": 14,
    "10♦": 14,
    "9♠": 13,
    "9♥": 13,
    "9♦": 13,
}
lookup_table[None]["♦"] = {
    "A♦": 24,
    "K♦": 23,
    "Q♦": 22,
    "J♦": 21,
    "10♦": 20,
    "9♦": 19,
    "A♠": 18,
    "A♥": 18,
    "A♣": 18,
    "K♠": 17,
    "K♥": 17,
    "K♣": 17,
    "Q♠": 16,
    "Q♥": 16,
    "Q♣": 16,
    "J♠": 15,
    "J♥": 15,
    "J♣": 15,
    "10♠": 14,
    "10♥": 14,
    "10♣": 14,
    "9♠": 13,
    "9♥": 13,
    "9♣": 13,
}
lookup_table[None][None] = {
    "A♠": 24,
    "A♥": 24,
    "A♣": 24,
    "A♦": 24,
    "K♠": 23,
    "K♥": 23,
    "K♣": 23,
    "K♦": 23,
    "Q♠": 22,
    "Q♥": 22,
    "Q♣": 22,
    "Q♦": 22,
    "J♠": 21,
    "J♥": 21,
    "J♣": 21,
    "J♦": 21,
    "10♠": 20,
    "10♥": 20,
    "10♣": 20,
    "10♦": 20,
    "9♠": 19,
    "9♥": 19,
    "9♣": 19,
    "9♦": 19,
}


def compare_cards(left: str, right: str, trump: Optional[str] = None, lead: Optional[str] = None) -> int:
    """
    Compare two cards based on their value in the lookup table.

    Args:
        left: The first card object.
        right: The second card object.
        lead (str, optional): The leading suit. Defaults to None.

    Returns:
        int: A positive number if left is greater than right,
             a negative number if right is greater than left,
             and 0 if they are equal.
    """
    lhs = lookup_table[trump][lead][left]
    rhs = lookup_table[trump][lead][right]
    return lhs - rhs


def best_card(left: str, right: str, trump: Optional[str] = None, lead: Optional[str] = None) -> int:
    """
    Determine the best card between two cards.

    Args:
        left: The first card object.
        right: The second card object.
        lead (str, optional): The leading suit. Defaults to None.

    Returns:
        The better of the two cards based on the lookup table.
        When tied the left card is considered better.
    """
    compare = compare_cards(left, right, trump, lead)
    if compare > 0:
        return left
    if compare < 0:
        return right
    return left


def worst_card(left: str, right: str, trump: Optional[str] = None, lead: Optional[str] = None) -> int:
    """
    Determine the worst card between two cards.

    Args:
        left: The first card object.
        right: The second card object.
        lead (str, optional): The leading suit. Defaults to None.

    Returns:
        The worse of the two cards based on the lookup table.
        When tied the right card is considered worse.
    """
    compare = compare_cards(left, right, trump, lead)
    if compare > 0:
        return right
    if compare < 0:
        return left
    return right
